<UserControl
  x:Class="YMM4TableShapePlugin.View.TableShapeEditor"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:c="clr-namespace:YukkuriMovieMaker.Controls;assembly=YukkuriMovieMaker.Controls"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:epoxy="https://github.com/kekyo/Epoxy"
  xmlns:local="clr-namespace:YMM4TableShapePlugin.View"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  Name="this"
  d:DesignWidth="300"
  epoxy:Fountain.Well="{Binding MainControlWell}"
  mc:Ignorable="d"
  >
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="150" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="8" />
    </Grid.RowDefinitions>

    <ItemsControl
      x:Name="tableLikeList"
      Grid.Row="0"
      Margin="0"
      Padding="0"
      HorizontalContentAlignment="Stretch"
      ItemsSource="{Binding Cells}"
      VirtualizingStackPanel.IsVirtualizing="True"
      VirtualizingStackPanel.VirtualizationMode="Recycling"
      >
      <ItemsControl.ItemTemplate>
        <DataTemplate>
          <ItemsControl
            Margin="0"
            Padding="0"
            HorizontalContentAlignment="Stretch"
            BorderBrush="Transparent"
            BorderThickness="0"
            ItemsSource="{Binding}"
            VirtualizingStackPanel.IsVirtualizing="True"
            VirtualizingStackPanel.VirtualizationMode="Recycling"
            >
            <ItemsControl.ItemsPanel>
              <ItemsPanelTemplate>
                <UniformGrid Margin="0" Rows="1" />
              </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
              <DataTemplate>
                <c:TextEditor
                  Height="30"
                  MinWidth="150"
                  Margin="0"
                  Padding="0"
                  HorizontalAlignment="Stretch"
                  epoxy:Fountain.Well="{Binding DataContext.TextEditorWell, RelativeSource={RelativeSource AncestorType=UserControl}}"
                  Text="{Binding Text, Mode=TwoWay}"
                  />
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>
        </DataTemplate>
      </ItemsControl.ItemTemplate>
    </ItemsControl>

    <!--  プロパティエディタ  -->
    <c:PropertiesEditor
      x:Name="innerPropertyEditor"
      Grid.Row="1"
      MinHeight="50"
      BeginEdit="InnerPropertiesEditor_BeginEdit"
      EndEdit="InnerPropertiesEditor_EndEdit"
      Target="{Binding SelectedCell}"
      />

    <Thumb
      x:Name="resizeThumb"
      Grid.Row="2"
      Height="8"
      VerticalAlignment="Bottom"
      Cursor="SizeNS"
      />
  </Grid>
</UserControl>
